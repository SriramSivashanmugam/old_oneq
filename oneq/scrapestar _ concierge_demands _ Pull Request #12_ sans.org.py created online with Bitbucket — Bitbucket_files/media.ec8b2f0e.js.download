!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirecbf3;r.register("9iFeJ",(function(n,i){t(n.exports,"default",(function(){return k}));var a=r("jgze0"),o=r("go2dD"),l=r("4NDMl"),c=r("47NZN"),d=r("9OLyr"),s=r("89Kz4"),u=r("eP3fJ"),f=r("l15hj"),p=r("61szk"),v=(p=r("61szk"),r("igW5C")),m=r("dhRB1"),h=r("jAS4L"),y=r("aj9Rm"),g=r("xZkvv");function C(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=e(u)(t);if(r){var a=e(u)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return e(s)(this,n)}}var k=function(t){e(d)(n,t);var r=C(n);function n(){var t;e(o)(this,n);for(var i=arguments.length,l=new Array(i),d=0;d<i;d++)l[d]=arguments[d];return t=r.call.apply(r,[this].concat(l)),e(f)(e(c)(t),"renderCard",(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.mediaProvider,i=r.contextIdentifierProvider,o=t.props,l=o.allowAltTextOnImages,c=o.alt,d=o.featureFlags,s=o.shouldOpenMediaViewer,u=t.props.marks.find(t.props.isLinkMark),f=null==u?void 0:u.attrs.href,h=f?void 0:t.props.eventHandlers,y=!f&&s,g=e(p).createElement(m.MediaCard,e(a)({mediaProvider:n,contextIdentifierProvider:i},t.props,{shouldOpenMediaViewer:y,eventHandlers:h,alt:l?c:void 0,featureFlags:d}));return f?e(p).createElement(v.MediaLink,{href:f,rel:"noreferrer noopener",onClick:t.handleMediaLinkClick,"data-block-link":f},g):g})),e(f)(e(c)(t),"handleMediaLinkClick",(function(e){var r=t.props,n=r.fireAnalyticsEvent,i=r.isLinkMark,a=r.marks;n&&n({action:y.ACTION.VISITED,actionSubject:y.ACTION_SUBJECT.MEDIA,actionSubjectId:y.ACTION_SUBJECT_ID.LINK,eventType:y.EVENT_TYPE.TRACK,attributes:{platform:g.PLATFORM.WEB,mode:g.MODE.RENDERER}});var o=t.props.marks.find(t.props.isLinkMark),l=null==o?void 0:o.attrs.href,c=h.getEventHandler(t.props.eventHandlers,"link");c&&c(e,a.find(i)&&l)})),t}return e(l)(n,[{key:"render",value:function(){var t=this.props.providers;return t?e(p).createElement(v.WithProviders,{providers:["mediaProvider","contextIdentifierProvider"],providerFactory:t,renderNode:this.renderCard}):this.renderCard()}}]),n}(p.PureComponent)})),r.register("dhRB1",(function(n,i){t(n.exports,"MediaCard",(function(){return M}));var a,o=r("lhkMJ"),l=r("9ePZF"),c=r("cNgp7"),d=r("go2dD"),s=r("4NDMl"),u=r("47NZN"),f=r("9OLyr"),p=r("89Kz4"),v=r("eP3fJ"),m=r("l15hj"),h=r("61szk"),y=(h=r("61szk"),r("2V4Fn")),g=r("kw77Z"),C=r("bKhep"),k=r("igW5C"),b=r("SssiD");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?O(Object(n),!0).forEach((function(r){e(m)(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=e(v)(t);if(r){var a=e(v)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return e(p)(this,n)}}var x=new Map,w=function(t){e(f)(i,t);var r,n=P(i);function i(){var t;e(d)(this,i);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=n.call.apply(n,[this].concat(a)),e(m)(e(u)(t),"state",{}),e(m)(e(u)(t),"saveFileState",function(){var r=e(c)(e(l).mark((function r(n,i){var a,o,c,d,s,u;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props,o=a.collection,c=a.featureFlags,d=C.getMediaClient(i,c),s={collectionName:o},e.prev=3,e.next=6,d.file.getCurrentState(n,s);case 6:u=e.sent,t.setState({fileState:u}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:case"end":return e.stop()}}),r,null,[[3,10]])})));return function(e,t){return r.apply(this,arguments)}}()),e(m)(e(u)(t),"renderLoadingCard",(function(){var r=t.props.cardDimensions;return e(h).createElement(g.CardLoading,{dimensions:r})})),e(m)(e(u)(t),"getOnCardClickCallback",(function(e){var r=t.props.eventHandlers;if(r&&r.media&&r.media.onClick)return function(t,n){var i=t.mediaItemDetails&&"video"===t.mediaItemDetails.mediaType;!(e&&i)&&r&&r.media&&r.media.onClick&&r.media.onClick(t,n)}})),t}return e(s)(i,[{key:"componentDidMount",value:(r=e(c)(e(l).mark((function t(){var r,n,i,a,o,c,d,s,u,f;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,n=r.rendererContext,i=r.mediaProvider,a=r.contextIdentifierProvider,o=r.id,c=r.url,d=r.collection,i){e.next=3;break}return e.abrupt("return");case 3:if(!a){e.next=10;break}return e.t0=this,e.next=7,a;case 7:e.t1=e.sent,e.t2={contextIdentifierProvider:e.t1},e.t0.setState.call(e.t0,e.t2);case 10:return e.next=12,i;case 12:s=e.sent,u=s.viewMediaClientConfig,f=o&&x.has(o)||c&&x.has(c),n&&n.adDoc&&!f&&(t=n.adDoc,t?y.filter(t,(function(e){return"media"===e.type})).reduce((function(e,t){if(t.attrs){var r=t.attrs,n=r.type,i=r.url,a=r.id;"file"===n&&a?e.push({mediaItemType:"file",id:a}):"external"===n&&i&&e.push({mediaItemType:"external-image",dataURI:i,name:i})}return e}),[]):[]).forEach((function(e){"file"===e.mediaItemType?x.set(e.id,I(I({},e),{},{collectionName:d})):"external-image"===e.mediaItemType&&x.set(e.dataURI,e)})),this.setState({mediaClientConfig:u}),o&&this.saveFileState(o,u);case 18:case"end":return e.stop()}var t}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.state.mediaClientConfig,r=e.id;t&&r&&r!==this.props.id&&this.saveFileState(r,t)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.id,r=e.url;t?x.delete(t):r&&x.delete(r)}},{key:"renderExternal",value:function(t){var r=this.state.mediaClientConfig,n=this.props,i=n.cardDimensions,a=n.resizeMode,o=n.appearance,l=n.url,c=n.imageStatus,d=n.disableOverlay,s=n.alt,u=n.featureFlags;if("loading"===c||!l)return this.renderLoadingCard();var f={dataURI:l,name:l,mediaItemType:"external-image"};return e(h).createElement(g.Card,{mediaClientConfig:r,alt:s,identifier:f,dimensions:i,appearance:o,resizeMode:a,disableOverlay:d,shouldOpenMediaViewer:t,mediaViewerDataSource:{list:Array.from(x.values())},featureFlags:u})}},{key:"render",value:function(){var t=this.state,r=t.contextIdentifierProvider,n=t.mediaClientConfig,i=t.fileState,a=this.props,o=a.id,l=a.alt,c=a.type,d=a.collection,s=a.occurrenceKey,u=a.cardDimensions,f=a.resizeMode,p=a.rendererAppearance,v=a.disableOverlay,m=a.useInlinePlayer,y=a.originalDimensions,C=a.shouldOpenMediaViewer,k=a.featureFlags,b="mobile"===p,O=!b&&(void 0===m||m),I=this.getOnCardClickCallback(O),P="boolean"==typeof C?C:!b&&!I;if("external"===c)return this.renderExternal(P);if("link"===c)return null;if(!n||!o)return this.renderLoadingCard();if(!o||"file"!==c)return e(h).createElement(g.CardError,{dimensions:u});var w=r&&r.objectId,M={id:o,mediaItemType:"file",collectionName:d,occurrenceKey:s};return e(h).createElement(E,D({id:o,alt:l,collection:d,contextIdentifierProvider:r,originalDimensions:y,fileState:i}),e(h).createElement(g.Card,{identifier:M,alt:l,contextId:w,mediaClientConfig:n,dimensions:u,originalDimensions:y,onClick:I,resizeMode:f,isLazy:!b,disableOverlay:v,useInlinePlayer:O,shouldOpenMediaViewer:P,mediaViewerDataSource:{list:Array.from(x.values())},featureFlags:k}))}}]),i}(h.Component),E=b.default.div(a||(a=e(o)([""]))),D=function(e){var t=e.id,r=e.alt,n=e.collection,i=e.contextIdentifierProvider,a=e.originalDimensions,o=e.fileState,l=i&&i.objectId,c=a&&a.width,d=a&&a.height,s="file",u=1,f="";return o&&"error"!==o.status&&(u=o.size,s=o.name,f=o.mimeType),{"data-context-id":l,"data-type":"file","data-node-type":"media","data-width":c,"data-height":d,"data-id":t,"data-collection":n,"data-file-name":s,"data-file-size":u,"data-file-mime-type":f,"data-alt":r}},M=k.withImageLoader(w)}))}();
//# sourceMappingURL=media.ec8b2f0e.js.map
